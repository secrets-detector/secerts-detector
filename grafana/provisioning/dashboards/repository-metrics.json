{"annotations":{"list":[]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":2,"links":[],"liveNow":false,"panels":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"custom":{"align":"auto","cellOptions":{"type":"auto"},"filterable":true,"inspect":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":5},{"color":"red","value":10}]}},"overrides":[]},"gridPos":{"h":8,"w":24,"x":0,"y":0},"id":1,"options":{"footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"showHeader":true,"sortBy":[{"desc":true,"displayName":"Total Detections"}]},"targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT r.owner, r.name as repository, COUNT(*) as total_detections, COUNT(DISTINCT secret_type) as unique_secret_types, COUNT(CASE WHEN is_blocked THEN 1 END) as blocked_pushes, MAX(detected_at) as last_detection, COUNT(CASE WHEN detected_at >= NOW() - INTERVAL '7 days' THEN 1 END) as detections_last_7d FROM secret_detections sd JOIN repositories r ON r.id = sd.repository_id GROUP BY r.owner, r.name ORDER BY total_detections DESC","format":"table"}],"title":"Repository Risk Overview","type":"table","transformations":[]},{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"bars","fillOpacity":80,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":8},"id":2,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT date_trunc('day', detected_at) as time, COUNT(*) as value, r.name as metric FROM secret_detections sd JOIN repositories r ON r.id = sd.repository_id WHERE detected_at >= NOW() - INTERVAL '30 days' GROUP BY 1, r.name ORDER BY 1","format":"time_series"}],"title":"Daily Detections by Repository","type":"timeseries"},{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[]},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":8},"id":3,"options":{"legend":{"displayMode":"table","placement":"right","showLegend":true,"values":["value","percent"]},"pieType":"pie","reduceOptions":{"calcs":["sum"],"fields":"","values":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT secret_type, COUNT(*) as value FROM secret_detections sd WHERE detected_at >= NOW() - INTERVAL '30 days' GROUP BY secret_type ORDER BY value DESC","format":"table"}],"title":"Secret Types Distribution","type":"piechart"},{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"align":"auto","cellOptions":{"type":"auto"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}},"overrides":[]},"gridPos":{"h":8,"w":24,"x":0,"y":16},"id":4,"options":{"footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"showHeader":true},"targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT r.owner, r.name as repository, sd.secret_type, sd.branch_name, sd.author, sd.commit_hash, sd.detected_at, sd.is_blocked FROM secret_detections sd JOIN repositories r ON r.id = sd.repository_id WHERE detected_at >= NOW() - INTERVAL '7 days' ORDER BY detected_at DESC LIMIT 100","format":"table"}],"title":"Recent Detections (Last 7 Days)","type":"table"},{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"custom":{"fillOpacity":70,"lineWidth":0,"spanNulls":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":24,"x":0,"y":24},"id":5,"options":{"calculate":false,"cellGap":1,"color":{"exponent":0.5,"fill":"dark-orange","mode":"scheme","reverse":false,"scale":"exponential","scheme":"RdYlGn","steps":64},"exemplars":{"color":"rgba(255,0,255,0.7)"},"filterValues":{"le":1e-9},"tooltip":{"show":true,"yHistogram":false},"yAxis":{"axisPlacement":"left","reverse":false}},"targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT date_trunc('day', detected_at) as time, r.name as metric, COUNT(*) as value FROM secret_detections sd JOIN repositories r ON r.id = sd.repository_id WHERE detected_at >= NOW() - INTERVAL '30 days' GROUP BY 1, 2 ORDER BY 1","format":"time_series"}],"title":"Detection Heatmap","type":"heatmap"}],"refresh":"5m","schemaVersion":38,"style":"dark","tags":["secrets","security","repositories"],"templating":{"list":[]},"time":{"from":"now-30d","to":"now"},"timepicker":{},"timezone":"","title":"Repository Secret Detection Metrics","uid":"repo-secrets-metrics","version":1,"weekStart":""}