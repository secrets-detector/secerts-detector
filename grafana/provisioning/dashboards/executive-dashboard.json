{"annotations":{"list":[]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":1,"links":[],"liveNow":false,"panels":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":5},{"color":"red","value":10}]}},"overrides":[]},"gridPos":{"h":8,"w":6,"x":0,"y":0},"id":1,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"auto"},"title":"Total Secrets (30 Days)","type":"stat","targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT COUNT(*) as value FROM secret_detections WHERE detected_at >= NOW() - INTERVAL '30 days'","format":"table"}]},{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}},"overrides":[]},"gridPos":{"h":8,"w":6,"x":6,"y":0},"id":2,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"auto"},"title":"Unique Repositories Affected","type":"stat","targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT COUNT(DISTINCT repository_id) as value FROM secret_detections WHERE detected_at >= NOW() - INTERVAL '30 days'","format":"table"}]},{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":20,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":0},"id":3,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT date_trunc('day', detected_at) as time, COUNT(*) as value FROM secret_detections WHERE detected_at >= NOW() - INTERVAL '30 days' GROUP BY 1 ORDER BY 1","format":"time_series"}],"title":"Daily Detection Trend","type":"timeseries"},{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[]},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":8},"id":4,"options":{"displayLabels":["value","percentage"],"legend":{"displayMode":"list","placement":"right","showLegend":true},"pieType":"pie","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":true},"tooltip":{"mode":"single","sort":"none"}},"title":"Secret Types Distribution","type":"piechart","targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT secret_type, COUNT(*) as value FROM secret_detections WHERE detected_at >= NOW() - INTERVAL '30 days' GROUP BY secret_type ORDER BY value DESC","format":"table"}]},{"datasource":{"type":"postgres","uid":"PostgreSQL"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"align":"auto","cellOptions":{"type":"auto"},"inspect":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":8},"id":5,"options":{"footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"showHeader":true},"title":"Top Repositories by Risk","type":"table","targets":[{"datasource":{"type":"postgres","uid":"PostgreSQL"},"sql":"SELECT r.owner, r.name as repository, COUNT(*) as total_detections, COUNT(DISTINCT secret_type) as unique_secret_types, MAX(detected_at) as last_detection FROM secret_detections sd JOIN repositories r ON r.id = sd.repository_id WHERE detected_at >= NOW() - INTERVAL '30 days' GROUP BY r.owner, r.name ORDER BY total_detections DESC LIMIT 10","format":"table"}]}],"refresh":"5m","schemaVersion":38,"style":"dark","tags":["secrets","security"],"templating":{"list":[]},"time":{"from":"now-30d","to":"now"},"timepicker":{},"timezone":"","title":"Secrets Detection Executive Dashboard","uid":"secrets-exec-dash","version":1,"weekStart":""}